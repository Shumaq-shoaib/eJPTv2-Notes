# 1.2 Footprinting & Scanning

> :bookmark\_tabs: **Prerequisites**
>
> * Basic familiarity with Linux
> * Basic networks concepts
>
> **ðŸ“• Learning Objectives**
>
> * Purpose of network mapping and port scanning in relation to an engagement
> * Perform network host discovery and port scanning
> * Think and act like an adversaryâ€‹

## Mapping a Network

Mapping a network refers to the process of discovering and documenting the devices, resources, and connections within a computer network. This involves creating a visual or written representation of the network's structure, which helps network administrators, IT professionals, and security experts understand how devices are interconnected and how data flows through the network. Important topics to cover well than last chapter are:

### IP

**IP** stands for Internet Protocol. It is a set of rules and protocols that govern how data packets are sent, routed, and received over computer networks, including the global internet. IP is an essential part of the modern networking infrastructure and is responsible for addressing and routing packets of data so that they can reach their intended destinations.

IP has two main versions that are commonly used:

1. **IPv4 (Internet Protocol version 4):** This is the older and most widely used version of IP. IPv4 addresses are 32-bit numerical labels, typically expressed as four decimal numbers separated by periods (e.g., 192.168.1.1). However, the rapid growth of the internet led to a depletion of available IPv4 addresses.
2. **IPv6 (Internet Protocol version 6):** IPv6 was developed to address the shortage of available IPv4 addresses. It uses 128-bit addresses, expressed as eight groups of hexadecimal numbers separated by colons (e.g., 2001:0db8:85a3:0000:0000:8a2e:0370:7334). IPv6 provides a much larger address space, ensuring that there are enough unique addresses to accommodate the growing number of devices connected to the internet.

IP provides several key functions in networking:

1. **Addressing:** IP addresses uniquely identify devices on a network or the internet. They allow data to be sent from one device to another across different networks, regardless of their physical location.
2. **Routing:** IP routers use routing tables to determine the best path for data packets to reach their destination. Routers make forwarding decisions based on the destination IP address in each packet.
3. **Fragmentation and Reassembly:** IP can fragment large data packets into smaller fragments for transmission and then reassemble them at the destination.
4. **Header:** IP adds a header to data packets that includes information such as the source and destination IP addresses, version of IP being used (IPv4 or IPv6), and other control information.
5. **Error Handling:** IP includes error-checking mechanisms to detect and handle errors that may occur during data transmission.

To find our IP we can use this command in \*nix systems:

```bash
ip -br -c a
# -br = brief
# -c  = color
```

### MAC Address

A **MAC** address, short for Media Access Control address, is a unique identifier assigned to a network interface card (NIC) of a physical device that connects to a network. It's used at the data link layer of the OSI model and is an essential component for communication within Ethernet or Wi-Fi networks. MAC addresses are assigned by the manufacturer and are intended to be globally unique.

A MAC address is a 48-bit hexadecimal number (12 characters), usually represented in pairs separated by colons or hyphens. For example, a MAC address might look like this: `00:1A:2B:3C:4D:5E`.

Here's a breakdown of the parts of a MAC address:

1. **OUI (Organizationally Unique Identifier):** The first 24 bits (6 characters) of a MAC address represent the manufacturer of the network interface. The IEEE assigns unique OUIs to manufacturers, so the first half of the MAC address can be used to identify the company that produced the NIC.
2. **NIC Specific Portion:** The remaining 24 bits (6 characters) are assigned by the manufacturer to uniquely identify the network interface card within their product line.

MAC addresses play a crucial role in networking, particularly in Ethernet and Wi-Fi networks. They are used for various purposes:

1. **Uniqueness:** MAC addresses are designed to be unique across the world, ensuring that no two devices have the same MAC address. This uniqueness is important to prevent conflicts in network communication.
2. **Addressing:** MAC addresses are used to address data packets at the data link layer. When devices communicate within a local network, they use MAC addresses to determine where to send data.
3. **ARP:** As mentioned earlier, MAC addresses are used in the ARP protocol to map IP addresses to physical addresses within a local network.
4. **Switching:** Ethernet switches use MAC addresses to make forwarding decisions. They maintain a MAC address table that associates MAC addresses with the ports on which devices are connected. This allows switches to efficiently forward data only to the port where the intended recipient is connected.
5. **Filtering:** Some networks use MAC address filtering as a security measure, only allowing devices with specific MAC addresses to connect to the network.

### ARP

**ARP** stands for Address Resolution Protocol. It is a communication protocol used in computer networks to map an IP address to a physical (MAC) address in a local network segment. In other words, ARP is used to discover the MAC address of a device when you know its IP address, and vice versa.

When a device wants to communicate with another device on the same local network, it needs to know the MAC address of that device to send data packets. Since devices typically use IP addresses for communication and MAC addresses for data link layer communication, ARP helps bridge the gap between these two types of addresses.

Here's how ARP works:

1. **ARP Request:** If a device wants to send data to another device whose IP address it knows but doesn't have the corresponding MAC address, it sends out an ARP request packet to the local network. This packet contains the target IP address and the MAC address of the sender.
2. **ARP Reply:** The device with the requested IP address responds to the ARP request with an ARP reply packet. This packet contains the sender's MAC address. The requesting device then updates its ARP cache with this information, associating the IP address with the MAC address.
3. **ARP Cache:** Devices maintain an ARP cache or ARP table, which is a local mapping of IP addresses to MAC addresses. This cache helps in avoiding repeated ARP requests for the same devices within a short period of time. The entries in the cache have a limited lifetime and may expire.

### Map Network Process

#### Physical Security

* **Physical Access:** Physical security encompasses measures such as access controls, surveillance cameras, and security personnel.
* **OSINT (Open Source Intelligence):** OSINT involves gathering information from DNS records, websites, and public IP addresses for intelligence purposes.
* **Social Engineering:** Social engineering involves manipulating individuals psychologically to induce security lapses or divulgence of sensitive information.

#### Sniffing

* **Sniffing:** After gaining access, sniffing entails passively observing network traffic through reconnaissance and packet capture techniques.
* **Collecting IP and MAC Addresses:** Gathering IP and MAC addresses is performed for subsequent enumeration and analysis purposes.

#### ARP

* **ARP (Address Resolution Protocol):** Leveraging the ARP table and broadcast communications, attackers can exploit the Address Resolution Protocol.

#### ICMP

* **ICMP (Internet Control Message Protocol):** ICMP serves purposes like traceroute and ping, aiding in network diagnostics and connectivity analysis.

### Tools

* [`wireshark`](1.2-footprinting-and-scanning.md#wireshark)
* [`arp-scan`](1.2-footprinting-and-scanning.md#arp-scan)
* [`ping`](1.2-footprinting-and-scanning.md#ping)
* [`fping`](1.2-footprinting-and-scanning.md#fping)
* [`nmap`](1.2-footprinting-and-scanning.md#nmap)
* [`zenmap`](1.2-footprinting-and-scanning.md#zenmap)

### [Wireshark](https://www.wireshark.org/)

{% content-ref url="http://127.0.0.1:5000/s/iS3hadq7jVFgSa8k5wRA/tools/wireshark-or-tcpdump" %}
[Wireshark or Tcpdump](http://127.0.0.1:5000/s/iS3hadq7jVFgSa8k5wRA/tools/wireshark-or-tcpdump)
{% endcontent-ref %}

First find our IP and netmask:

<div align="left">

<figure><img src="../../.gitbook/assets/Schermata del 2023-08-05 18-50-08.png" alt=""><figcaption></figcaption></figure>

</div>

Our up network interface is `eth0` and IP is `10.0.2.15/24`, then we can scan `10.0.2.0`.

After this, run Wireshark and start to monitoring the internet network interface (eth0);

and execute an "arp-scan" on the identical interface and see the traffic within Wireshark.

<figure><img src="../../.gitbook/assets/Schermata del 2023-08-05 18-41-30.png" alt=""><figcaption></figcaption></figure>

Here's below arp packet in Wireshark details:

<figure><img src="../../.gitbook/assets/Schermata del 2023-08-05 18-44-30.png" alt=""><figcaption></figcaption></figure>















## Exercises











## Challenge
